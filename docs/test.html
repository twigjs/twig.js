make[1]: Entering directory `/home/john/workspace/twig.js'
    <section class="suite">
      <h1>Twig.js Control Structures -></h1>
      <dl>
        <section class="suite">
          <h1>if tag -></h1>
          <dl>
            <dt>should parse the contents of the if block if the expression is true</dt>
            <dd><pre><code>
var test_template = twig({data: '{% if test %}true{% endif%}'});
test_template.render({test: true}).should.equal(&quot;true&quot; );
test_template.render({test: false}).should.equal(&quot;&quot; );</code></pre></dd>
            <dt>should call the if or else blocks based on the expression result</dt>
            <dd><pre><code>
var test_template = twig({data: '{% if test %}true{% endif%}'});
test_template.render({test: true}).should.equal(&quot;true&quot; );
test_template.render({test: false}).should.equal(&quot;&quot; );</code></pre></dd>
            <dt>should support elseif</dt>
            <dd><pre><code>
var test_template = twig({data: '{% if test %}1{% elseif other %}2{%else%}3{% endif%}'});
test_template.render({test: true, other:false}).should.equal(&quot;1&quot; );
test_template.render({test: true, other:true}).should.equal(&quot;1&quot; );
test_template.render({test: false, other:true}).should.equal(&quot;2&quot; );
test_template.render({test: false, other:false}).should.equal(&quot;3&quot; );</code></pre></dd>
            <dt>should be able to nest</dt>
            <dd><pre><code>
var test_template = twig({data: '{% if test %}{% if test2 %}true{% else %}false{% endif%}{% else %}not{% endif%}'});
test_template.render({test: true, test2: true}).should.equal(&quot;true&quot; );
test_template.render({test: true, test2: false}).should.equal(&quot;false&quot; );
test_template.render({test: false, test2: true}).should.equal(&quot;not&quot; );
test_template.render({test: false, test2: false}).should.equal(&quot;not&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>for tag -></h1>
          <dl>
            <dt>should provide value only for array input</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for value in test %}{{ value }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;1234&quot; );
test_template.render({test: []}).should.equal(&quot;&quot; );</code></pre></dd>
            <dt>should provide both key and value for array input</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for key,value in test %}{{key}}:{{ value }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;0:11:22:33:4&quot; );
test_template.render({test: []}).should.equal(&quot;&quot; );</code></pre></dd>
            <dt>should provide value only for object input</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for value in test %}{{ value }}{% endfor %}'});
test_template.render({test: {one: 1, two: 2, three: 3}}).should.equal(&quot;123&quot; );
test_template.render({test: {}}).should.equal(&quot;&quot; );</code></pre></dd>
            <dt>should provide both key and value for object input</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for key, value in test %}{{key}}:{{ value }}{% endfor %}'});
test_template.render({test: {one: 1, two: 2, three: 3}}).should.equal(&quot;one:1two:2three:3&quot; );
test_template.render({test: {}}).should.equal(&quot;&quot; );</code></pre></dd>
            <dt>should support else if the input is empty</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for key,value in test %}{{ value }}{% else %}else{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;1234&quot; );
test_template.render({test: []}).should.equal(&quot;else&quot; );</code></pre></dd>
            <dt>should be able to nest</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for key,list in test %}{% for val in list %}{{ val }}{%endfor %}.{% else %}else{% endfor %}'});
test_template.render({test: [[1,2],[3,4],[5,6]]}).should.equal(&quot;12.34.56.&quot; );
test_template.render({test: []}).should.equal(&quot;else&quot; );</code></pre></dd>
            <dt>should have a loop context item available for arrays</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for key,value in test %}{{ loop.index }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;1234&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.index0 }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;0123&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.revindex }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;4321&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.revindex0 }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;3210&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.length }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;4444&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.first }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;truefalsefalsefalse&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.last }}{% endfor %}'});
test_template.render({test: [1,2,3,4]}).should.equal(&quot;falsefalsefalsetrue&quot; );</code></pre></dd>
            <dt>should have a loop context item available for objects</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for key,value in test %}{{ loop.index }}{% endfor %}'});
test_template.render({test: {a:1,b:2,c:3,d:4}}).should.equal(&quot;1234&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.index0 }}{% endfor %}'});
test_template.render({test: {a:1,b:2,c:3,d:4}}).should.equal(&quot;0123&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.revindex }}{% endfor %}'});
test_template.render({test: {a:1,b:2,c:3,d:4}}).should.equal(&quot;4321&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.revindex0 }}{% endfor %}'});
test_template.render({test: {a:1,b:2,c:3,d:4}}).should.equal(&quot;3210&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.length }}{% endfor %}'});
test_template.render({test: {a:1,b:2,c:3,d:4}}).should.equal(&quot;4444&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.first }}{% endfor %}'});
test_template.render({test: {a:1,b:2,c:3,d:4}}).should.equal(&quot;truefalsefalsefalse&quot; );
test_template = twig({data: '{% for key,value in test %}{{ loop.last }}{% endfor %}'});
test_template.render({test: {a:1,b:2,c:3,d:4}}).should.equal(&quot;falsefalsefalsetrue&quot; );</code></pre></dd>
            <dt>should have a loop context item available in child loops objects</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for value in test %}{% for value in inner %}({{ loop.parent.loop.index }},{{ loop.index }}){% endfor %}{% endfor %}'});
test_template.render({test: {a:1,b:2}, inner:[1,2,3]}).should.equal(&quot;(1,1)(1,2)(1,3)(2,1)(2,2)(2,3)&quot;);</code></pre></dd>
            <dt>should support conditionals on for loops</dt>
            <dd><pre><code>
var test_template = twig({data: '{% for value in test if false %}{{ value }},{% endfor %}'});
test_template.render({test: [&quot;one&quot;, &quot;two&quot;, &quot;a&quot;, &quot;b&quot;, &quot;other&quot;]}).should.equal(&quot;&quot;);

test_template = twig({data: '{% for value in test if true %}{{ value }}{% endfor %}'});
test_template.render({test: [&quot;a&quot;, &quot;s&quot;, &quot;d&quot;, &quot;f&quot;]}).should.equal(&quot;asdf&quot;);

test_template = twig({data: '{% for value in test if value|length &gt; 2 %}{{ value }},{% endfor %}'});
test_template.render({test: [&quot;one&quot;, &quot;two&quot;, &quot;a&quot;, &quot;b&quot;, &quot;other&quot;]}).should.equal(&quot;one,two,other,&quot;);

test_template = twig({data: '{% for key,item in test if item.show %}{{key}}:{{ item.value }},{% endfor %}'});
test_template.render({test: {
    a: {show:true, value: &quot;one&quot;},
    b: {show:false, value: &quot;two&quot;},
    c: {show:true, value: &quot;three&quot;}}}).should.equal(&quot;a:one,c:three,&quot;);</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>set tag -></h1>
          <dl>
            <dt>should set the global context from within a for loop</dt>
            <dd><pre><code>
var test_template = twig({data: '{% set value=&quot;wrong&quot; %}{% for value in [1] %}{% set value=&quot;right&quot; %}{% endfor %}{{value}}'});
test_template.render().should.equal(&quot;right&quot;);</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Core -></h1>
      <dl>
        <dt>should save and load a template by reference</dt>
        <dd><pre><code>

        // Define and save a template
        twig({
            id:   'test',
            data: '{{ &quot;test&quot; }}'
        });

        // Load and render the template
        twig({ref: 'test'}).render()
                .should.equal(&quot;test&quot;);</code></pre></dd>
        <dt>should be able to parse output tags with tag ends in strings</dt>
        <dd><pre><code>
// Really all we care about here is not throwing exceptions.
twig({data: '{{ &quot;test&quot; }}'}).render().should.equal(&quot;test&quot;);
twig({data: '{{ &quot; }} &quot; }}'}).render().should.equal(&quot; }} &quot;);
twig({data: '{{ &quot; \\&quot;}} &quot; }}'}).render().should.equal(' &quot;}} ');
twig({data: &quot;{{ ' }} ' }}&quot;}).render().should.equal(&quot; }} &quot;);
twig({data: &quot;{{ ' \\'}} ' }}&quot;}).render().should.equal(&quot; '}} &quot;);

twig({data: '{{ &quot; \'}} &quot; }}'}).render().should.equal(&quot; '}} &quot;);
twig({data: &quot;{{ ' \&quot;}} ' }}&quot;}).render().should.equal(' &quot;}} ');</code></pre></dd>
        <dt>should be able to output numbers</dt>
        <dd><pre><code>
twig({data: '{{ 12 }}'}).render().should.equal( &quot;12&quot; );
twig({data: '{{ 12.64 }}'}).render().should.equal( &quot;12.64&quot; );
twig({data: '{{ 0.64 }}'}).render().should.equal(&quot;0.64&quot; );</code></pre></dd>
        <dt>should be able to output booleans</dt>
        <dd><pre><code>
twig({data: '{{ true }}'}).render().should.equal( &quot;true&quot; );
twig({data: '{{ false }}'}).render().should.equal( &quot;false&quot; );</code></pre></dd>
        <dt>should be able to output strings</dt>
        <dd><pre><code>
twig({data: '{{ &quot;double&quot; }}'}).render().should.equal(&quot;double&quot;);
twig({data: &quot;{{ 'single' }}&quot;}).render().should.equal('single');
twig({data: '{{ &quot;dou\'ble&quot; }}'}).render().should.equal(&quot;dou'ble&quot;);
twig({data: &quot;{{ 'sin\&quot;gle' }}&quot;}).render().should.equal('sin&quot;gle');
twig({data: '{{ &quot;dou\\&quot;ble&quot; }}'}).render().should.equal(&quot;dou\&quot;ble&quot;);
twig({data: &quot;{{ 'sin\\'gle' }}&quot;}).render().should.equal(&quot;sin'gle&quot;);</code></pre></dd>
        <dt>should be able to output arrays</dt>
        <dd><pre><code>
twig({data: '{{ [1] }}'}).render().should.equal(&quot;1&quot; );
twig({data: '{{ [1,2 ,3 ] }}'}).render().should.equal(&quot;1,2,3&quot; );
twig({data: '{{ [1,2 ,3 , val ] }}'}).render({val: 4}).should.equal(&quot;1,2,3,4&quot; );
twig({data: '{{ [&quot;[to&quot;,\'the\' ,&quot;string]&quot; ] }}'}).render().should.equal('[to,the,string]' );
twig({data: '{{ [&quot;[to&quot;,\'the\' ,&quot;str\\&quot;ing]&quot; ] }}'}).render().should.equal('[to,the,str&quot;ing]' );</code></pre></dd>
        <dt>should be able to output parse expressions in an array</dt>
        <dd><pre><code>
twig({data: '{{ [1,2 ,1+2 ] }}'}).render().should.equal(&quot;1,2,3&quot; );
twig({data: '{{ [1,2 ,3 , &quot;-&quot;, [4,5, 6] ] }}'}).render({val: 4}).should.equal(&quot;1,2,3,-,4,5,6&quot; );
twig({data: '{{ [a,b ,(1+2) * a ] }}'}).render({a:1,b:2}).should.equal(&quot;1,2,3&quot; );</code></pre></dd>
        <dt>should be able to output variables</dt>
        <dd><pre><code>
twig({data: '{{ orp }}'}).render({ orp: &quot;test&quot;}).should.equal(&quot;test&quot;);
twig({data: '{{ val }}'}).render({ val: function() {
                                              return &quot;test&quot;
                                          }}).should.equal(&quot;test&quot;);</code></pre></dd>
        <dt>should recognize null</dt>
        <dd><pre><code>
twig({data: '{{ null == val }}'}).render({val: null}).should.equal( &quot;true&quot; );
twig({data: '{{ null == val }}'}).render({val: undefined}).should.equal( &quot;true&quot; );

twig({data: '{{ null == val }}'}).render({val: &quot;test&quot;}).should.equal( &quot;false&quot; );
twig({data: '{{ null == val }}'}).render({val: 0}).should.equal( &quot;false&quot; );
twig({data: '{{ null == val }}'}).render({val: false}).should.equal( &quot;false&quot; );</code></pre></dd>
        <dt>should recognize object literals</dt>
        <dd><pre><code>
twig({data: '{% set at = {&quot;foo&quot;: &quot;test&quot;, bar: &quot;other&quot;, 1:&quot;zip&quot;} %}{{ at.foo ~ at.bar ~ at.1 }}'}).render().should.equal( &quot;testotherzip&quot; );</code></pre></dd>
        <dt>should recognize null in an object</dt>
        <dd><pre><code>
twig({data: '{% set at = {&quot;foo&quot;: null} %}{{ at.foo == val }}'}).render({val: null}).should.equal( &quot;true&quot; );</code></pre></dd>
        <section class="suite">
          <h1>Key Notation -></h1>
          <dl>
            <dt>should support dot key notation</dt>
            <dd><pre><code>
twig({data: '{{ key.value }} {{ key.sub.test }}'}).render({
    key: {
        value: &quot;test&quot;,
        sub: {
            test: &quot;value&quot;
        }
    }
}).should.equal(&quot;test value&quot;);</code></pre></dd>
            <dt>should support square bracket key notation</dt>
            <dd><pre><code>
twig({data: '{{ key[&quot;value&quot;] }} {{ key[\'sub\'][&quot;test&quot;] }}'}).render({
    key: {
        value: &quot;test&quot;,
        sub: {
            test: &quot;value&quot;
        }
    }
}).should.equal(&quot;test value&quot;);</code></pre></dd>
            <dt>should support mixed dot and bracket key notation</dt>
            <dd><pre><code>
twig({data: '{{ key[&quot;value&quot;] }} {{ key.sub[key.value] }} {{ s.t[&quot;u&quot;].v[&quot;w&quot;] }}'}).render({
    key: {
        value: &quot;test&quot;,
        sub: {
            test: &quot;value&quot;
        }
    },
    s: { t: { u: { v: { w: 'x' } } } }
}).should.equal(&quot;test value x&quot; );</code></pre></dd>
            <dt>should support dot key notation after a function</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ key.fn().value }}'});
var output = test_template.render({
    key: {
        fn: function() {
            return {
                value: &quot;test&quot;
            }
        }
    }
});
output.should.equal(&quot;test&quot;);</code></pre></dd>
            <dt>should support bracket key notation after a function</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ key.fn()[&quot;value&quot;] }}'});
var output = test_template.render({
    key: {
        fn: function() {
            return {
                value: &quot;test 2&quot;
            }
        }
    }
});
output.should.equal(&quot;test 2&quot;);</code></pre></dd>
            <dt>should check for getKey methods if a key doesn't exist.</dt>
            <dd><pre><code>
twig({data: '{{ obj.value }}'}).render({
    obj: {
        getValue: function() {
            return &quot;val&quot;;
        },
        isValue: function() {
            return &quot;not val&quot;;
        }
    }
}).should.equal(&quot;val&quot;);</code></pre></dd>
            <dt>should check for isKey methods if a key doesn't exist.</dt>
            <dd><pre><code>
twig({data: '{{ obj.value }}'}).render({
    obj: {
        isValue: function() {
            return &quot;val&quot;;
        }
    }
}).should.equal(&quot;val&quot;);</code></pre></dd>
            <dt>should check for getKey methods on prototype objects.</dt>
            <dd><pre><code>
			var object = {
                getValue: function() {
                    return &quot;val&quot;;
                }
            };
			function Subobj() {};
			Subobj.prototype = object;
			var subobj = new Subobj();

            twig({data: '{{ obj.value }}'}).render({
                obj: subobj
            }).should.equal(&quot;val&quot;);</code></pre></dd>
            <dt>should return null if a period key doesn't exist.</dt>
            <dd><pre><code>
twig({data: '{{ obj.value == null }}'}).render({
    obj: {}
}).should.equal(&quot;true&quot;);</code></pre></dd>
            <dt>should return null if a bracket key doesn't exist.</dt>
            <dd><pre><code>
twig({data: '{{ obj[&quot;value&quot;] == null }}'}).render({
    obj: {}
}).should.equal(&quot;true&quot;);</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Expressions -></h1>
      <dl>
        <section class="suite">
          <h1>Basic Operators -></h1>
          <dl>
            <dt>should add numbers</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a + b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal( (pair.a + pair.b).toString() );
});</code></pre></dd>
            <dt>should subtract numbers</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a - b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal( (pair.a - pair.b).toString() );
});</code></pre></dd>
            <dt>should multiply numbers</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a * b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a * pair.b).toString() );
});</code></pre></dd>
            <dt>should divide numbers</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a / b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a / pair.b).toString() );
});</code></pre></dd>
            <dt>should divide numbers and return an int result</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a // b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    // Get expected truncated result
    var c = parseInt(pair.a/pair.b);

    output.should.equal(c.toString() );
});</code></pre></dd>
            <dt>should raise numbers to a power</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a ** b }}'});
var pow_test_data = [
    {a: 2, b:3, c: 8}
    , {a: 4, b:.5, c: 2}
    , {a: 5, b: 1, c: 5}
];
pow_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal(pair.c.toString() );
});</code></pre></dd>
            <dt>should concatanate values</dt>
            <dd><pre><code>
twig({data: '{{ &quot;test&quot; ~ a }}'}).render({a:1234}).should.equal(&quot;test1234&quot;);
twig({data: '{{ a ~ &quot;test&quot; ~ a }}'}).render({a:1234}).should.equal(&quot;1234test1234&quot;);
twig({data: '{{ &quot;this&quot; ~ &quot;test&quot; }}'}).render({a:1234}).should.equal(&quot;thistest&quot;);

// Test numbers
var test_template = twig({data: '{{ a ~ b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal(pair.a.toString() + pair.b.toString());
});
// Test strings
test_template = twig({data: '{{ a ~ b }}'});
string_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal(pair.a.toString() + pair.b.toString());
});</code></pre></dd>
            <dt>should handle multiple chained operations</dt>
            <dd><pre><code>
var data = {a: 4.5, b: 10, c: 12,  d: -0.25, e:0, f: 65,  g: 21, h: -0.0002};
var test_template = twig({data: '{{a/b+c*d-e+f/g*h}}'});
var output = test_template.render(data);
var expected = data.a / data.b + data.c * data.d - data.e + data.f / data.g * data.h;
output.should.equal(expected.toString());</code></pre></dd>
            <dt>should handle parenthesis in chained operations</dt>
            <dd><pre><code>
var data = {a: 4.5, b: 10, c: 12,  d: -0.25, e:0, f: 65,  g: 21, h: -0.0002};
var test_template = twig({data: '{{a   /(b+c )*d-(e+f)/(g*h)}}'});
var output = test_template.render(data);
var expected = data.a / (data.b + data.c) * data.d - (data.e + data.f) / (data.g * data.h);
output.should.equal(expected.toString());</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>Comparison Operators -></h1>
          <dl>
            <dt>should support less then</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a &lt; b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a &lt; pair.b).toString() );
});</code></pre></dd>
            <dt>should support less then or equal</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a &lt;= b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a &lt;= pair.b).toString() );
});</code></pre></dd>
            <dt>should support greater then</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a &gt; b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a &gt; pair.b).toString() );
});</code></pre></dd>
            <dt>should support greater then or equal</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a &gt;= b }}'});
numeric_test_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a &gt;= pair.b).toString() );
});</code></pre></dd>
            <dt>should support equals</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a == b }}'});
boolean_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a == pair.b).toString() );
});
equality_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a == pair.b).toString() );
});</code></pre></dd>
            <dt>should support not equals</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a != b }}'});
boolean_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a != pair.b).toString() );
});
equality_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a != pair.b).toString() );
});</code></pre></dd>
            <dt>should support boolean or</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a or b }}'});
boolean_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a || pair.b).toString() );
});</code></pre></dd>
            <dt>should support boolean and</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a and b }}'});
boolean_data.forEach(function(pair) {
    var output = test_template.render(pair);
    output.should.equal((pair.a &amp;&amp; pair.b).toString() );
});</code></pre></dd>
            <dt>should support boolean not</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ not a }}'});
test_template.render({a:false}).should.equal(true.toString());
test_template.render({a:true}).should.equal(false.toString());</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>Other Operators -></h1>
          <dl>
            <dt>should support the ternary operator</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ a ? b:c }}'})
    , output_t = test_template.render({a: true,  b: &quot;one&quot;, c: &quot;two&quot;})
    , output_f = test_template.render({a: false, b: &quot;one&quot;, c: &quot;two&quot;});

output_t.should.equal( &quot;one&quot; );
output_f.should.equal( &quot;two&quot; );</code></pre></dd>
            <dt>should support the ternary operator with objects in it</dt>
            <dd><pre><code>
var test_template2 = twig({data: '{{ (a ? {&quot;a&quot;:e+f}:{&quot;a&quot;:1}).a }}'})
    , output2 = test_template2.render({a: true, b: false, e: 1, f: 2});

output2.should.equal( &quot;3&quot; );</code></pre></dd>
            <dt>should support the ternary operator inside objects</dt>
            <dd><pre><code>
var test_template2 = twig({data: '{{ {&quot;b&quot; : a or b ? {&quot;a&quot;:e+f}:{&quot;a&quot;:1} }.b.a }}'})
    , output2 = test_template2.render({a: false, b: false, e: 1, f: 2});

output2.should.equal( &quot;1&quot; );</code></pre></dd>
            <dt>should support in/containment functionality for arrays</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;a&quot; in [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;] }}'});
test_template.render().should.equal(true.toString());

var test_template = twig({data: '{{ &quot;d&quot; in [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;] }}'});
test_template.render().should.equal(false.toString());</code></pre></dd>
            <dt>should support not in/containment functionality for arrays</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;a&quot; not in [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;] }}'});
test_template.render().should.equal(false.toString());

var test_template = twig({data: '{{ &quot;d&quot; not in [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;] }}'});
test_template.render().should.equal(true.toString());</code></pre></dd>
            <dt>should support in/containment functionality for strings</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;at&quot; in &quot;hat&quot; }}'});
test_template.render().should.equal(true.toString());

var test_template = twig({data: '{{ &quot;d&quot; in &quot;not&quot; }}'});
test_template.render().should.equal(false.toString());</code></pre></dd>
            <dt>should support not in/containment functionality for strings</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;at&quot; not in &quot;hat&quot; }}'});
test_template.render().should.equal(false.toString());

var test_template = twig({data: '{{ &quot;d&quot; not in &quot;not&quot; }}'});
test_template.render().should.equal(true.toString());</code></pre></dd>
            <dt>should support in/containment functionality for objects</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;value&quot; in {&quot;key&quot; : &quot;value&quot;, &quot;2&quot;: &quot;other&quot;} }}'});
test_template.render().should.equal(true.toString());

var test_template = twig({data: '{{ &quot;d&quot; in {&quot;key_a&quot; : &quot;no&quot;} }}'});
test_template.render().should.equal(false.toString());</code></pre></dd>
            <dt>should support not in/containment functionality for objects</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;value&quot; not in {&quot;key&quot; : &quot;value&quot;, &quot;2&quot;: &quot;other&quot;} }}'});
test_template.render().should.equal(false.toString());

var test_template = twig({data: '{{ &quot;d&quot; not in {&quot;key_a&quot; : &quot;no&quot;} }}'});
test_template.render().should.equal(true.toString());</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Filters -></h1>
      <dl>
        <dt>should chain</dt>
        <dd><pre><code>
var test_template = twig({data: '{{ [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]|keys|reverse }}' });
test_template.render().should.equal(&quot;2,1,0&quot; );</code></pre></dd>
        <section class="suite">
          <h1>url_encode -></h1>
          <dl>
            <dt>should encode URLs</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;http://google.com/?q=twig.js&quot;|url_encode() }}' });
test_template.render().should.equal(&quot;http%3A%2F%2Fgoogle.com%2F%3Fq%3Dtwig.js&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>json_encode -></h1>
          <dl>
            <dt>should encode strings to json</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ test|json_encode }}' });
test_template.render({test:'value'}).should.equal('&quot;value&quot;' );</code></pre></dd>
            <dt>should encode numbers to json</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ test|json_encode }}' });
test_template.render({test:21}).should.equal('21' );</code></pre></dd>
            <dt>should encode arrays to json</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ [1,&quot;b&quot;,3]|json_encode }}' });
test_template.render().should.equal('[1,&quot;b&quot;,3]' );</code></pre></dd>
            <dt>should encode objects to json</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ {&quot;a&quot;:[1,&quot;b&quot;,3]}|json_encode }}' });
test_template.render().should.equal('{&quot;a&quot;:[1,&quot;b&quot;,3]}' );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>upper -></h1>
          <dl>
            <dt>should convert text to uppercase</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;hello&quot;|upper }}' });
test_template.render().should.equal(&quot;HELLO&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>lower -></h1>
          <dl>
            <dt>should convert text to lowercase</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;HELLO&quot;|lower }}' });
test_template.render().should.equal(&quot;hello&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>capitalize -></h1>
          <dl>
            <dt>should capitalize the first word in a string</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;hello world&quot;|capitalize }}' });
test_template.render().should.equal(&quot;Hello world&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>title -></h1>
          <dl>
            <dt>should capitalize all the words in a string</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;hello world&quot;|title }}' });
test_template.render().should.equal(&quot;Hello World&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>length -></h1>
          <dl>
            <dt>should determine the length of a string</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;test&quot;|length }}' });
test_template.render().should.equal(&quot;4&quot;);</code></pre></dd>
            <dt>should determine the length of an array</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ [1,2,4,76,&quot;tesrt&quot;]|length }}' });
test_template.render().should.equal(&quot;5&quot;);</code></pre></dd>
            <dt>should determine the length of an object</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ {&quot;a&quot;: &quot;b&quot;, &quot;c&quot;: &quot;1&quot;, &quot;test&quot;: &quot;test&quot;}|length }}' });
test_template.render().should.equal(&quot;3&quot;);</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>sort -></h1>
          <dl>
            <dt>should sort an array</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ [1,5,2,7]|sort }}' });
test_template.render().should.equal(&quot;1,2,5,7&quot; );
        
test_template = twig({data: '{{ [&quot;test&quot;,&quot;abc&quot;,2,7]|sort }}' });
test_template.render().should.equal(&quot;2,7,abc,test&quot; );</code></pre></dd>
            <dt>should sort an object</dt>
            <dd><pre><code>
var test_template = twig({data: &quot;{% set obj =  {'c': 1,'d': 5,'t': 2,'e':7}|sort %}{% for key,value in obj|sort %}{{key}}:{{value}} {%endfor %}&quot; });
test_template.render().should.equal(&quot;c:1 t:2 d:5 e:7 &quot; );
        
test_template = twig({data: &quot;{% set obj = {'m':'test','z':'abc','a':2,'y':7} %}{% for key,value in obj|sort %}{{key}}:{{value}} {%endfor %}&quot; });
test_template.render().should.equal(&quot;a:2 y:7 z:abc m:test &quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>reverse -></h1>
          <dl>
            <dt>should reverse an array</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]|reverse }}' });
test_template.render().should.equal(&quot;c,b,a&quot; );</code></pre></dd>
            <dt>should reverse an object</dt>
            <dd><pre><code></code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>keys -></h1>
          <dl>
            <dt>should return the keys of an array</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]|keys }}' });
test_template.render().should.equal(&quot;0,1,2&quot; );</code></pre></dd>
            <dt>should return the keys of an object</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ {&quot;a&quot;: 1, &quot;b&quot;: 4, &quot;c&quot;: 5}|keys }}' });
test_template.render().should.equal(&quot;a,b,c&quot; );

test_template = twig({data: '{{ {&quot;0&quot;:&quot;a&quot;, &quot;1&quot;:&quot;b&quot;, &quot;2&quot;:&quot;c&quot;}|keys }}' });
test_template.render().should.equal(&quot;0,1,2&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>merge -></h1>
          <dl>
            <dt>should merge two objects into an object</dt>
            <dd><pre><code>
// Object merging
var test_template = twig({data: '{% set obj= {&quot;a&quot;:&quot;test&quot;, &quot;b&quot;:&quot;1&quot;}|merge({&quot;b&quot;:2,&quot;c&quot;:3}) %}{% for key in obj|keys|sort %}{{key}}:{{obj[key]}} {%endfor %}' });
test_template.render().should.equal('a:test b:2 c:3 ' );</code></pre></dd>
            <dt>should merge two arrays into and array</dt>
            <dd><pre><code>
// Array merging
var test_template = twig({data: '{% set obj= [&quot;a&quot;, &quot;b&quot;]|merge([&quot;c&quot;, &quot;d&quot;]) %}{% for key in obj|keys|sort %}{{key}}:{{obj[key]}} {%endfor %}' });
test_template.render().should.equal('0:a 1:b 2:c 3:d ' );</code></pre></dd>
            <dt>should merge an object and an array into an object</dt>
            <dd><pre><code>
// Mixed merging
var test_template = twig({data: '{% set obj= [&quot;a&quot;, &quot;b&quot;]|merge({&quot;a&quot;: &quot;c&quot;, &quot;3&quot;:4}, [&quot;c&quot;, &quot;d&quot;]) %}{% for key in obj|keys|sort %}{{key}}:{{obj[key]}} {%endfor %}' });
test_template.render().should.equal('0:a 1:b 3:4 4:c 5:d a:c ' );
        
// Mixed merging(2)
test_template = twig({data: '{% set obj= {&quot;1&quot;:&quot;a&quot;, &quot;a&quot;:&quot;b&quot;}|merge([&quot;c&quot;, &quot;d&quot;]) %}{% for key in obj|keys %}{{key}}:{{obj[key]}} {%endfor %}' });
test_template.render().should.equal('1:a a:b 2:c 3:d ' );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>join -></h1>
          <dl>
            <dt>should join all values in an object</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ {&quot;a&quot;:&quot;1&quot;, &quot;b&quot;: &quot;b&quot;, &quot;c&quot;:test}|join(&quot;-&quot;) }}' });
test_template.render({&quot;test&quot;: &quot;t&quot;}).should.equal(&quot;1-b-t&quot; );</code></pre></dd>
            <dt>should joing all values in an array</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ [1,2,4,76]|join }}' });
test_template.render().should.equal(&quot;12476&quot; );
test_template = twig({data: '{{ [1+ 5,2,4,76]|join(&quot;-&quot; ~ &quot;.&quot;) }}' });
test_template.render().should.equal(&quot;6-.2-.4-.76&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>default -></h1>
          <dl>
            <dt>should not provide the default value if a key is defined and not empty</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ var|default(&quot;Not Defined&quot;) }}' });
test_template.render({&quot;var&quot;:&quot;value&quot;}).should.equal(&quot;value&quot; );</code></pre></dd>
            <dt>should provide a default value if a key is not defined</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ var|default(&quot;Not Defined&quot;) }}' });
test_template.render().should.equal(&quot;Not Defined&quot; );</code></pre></dd>
            <dt>should provide a default value if a value is empty</dt>
            <dd><pre><code>
var test_template = twig({data: '{{ &quot;&quot;|default(&quot;Empty String&quot;) }}' });
test_template.render().should.equal(&quot;Empty String&quot; );
        
test_template = twig({data: '{{ var.key|default(&quot;Empty Key&quot;) }}' });
test_template.render({'var':{}}).should.equal(&quot;Empty Key&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>date -></h1>
          <dl>
            <dt>should recognize timestamps</dt>
            <dd><pre><code>
           var template = twig({data: '{{ 27571323556|date(&quot;d/m/Y @ H:i:s&quot;) }}'})
               , date = new Date(27571323556000); // 13/09/2843 @ 08:59:16 EST
           
           template.render().should.equal( stringDate(date) );</code></pre></dd>
            <dt>should recognize string date formats</dt>
            <dd><pre><code>
           var template = twig({data: '{{ &quot;Tue Aug 14 08:52:15 +0000 2007&quot;|date(&quot;d/m/Y @ H:i:s&quot;) }}'})
               , date = new Date(1187081535000); // 14/08/2007 @ 04:52:15 EST

           template.render().should.equal( stringDate(date) );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>replace -></h1>
          <dl>
            <dt>should replace strings provided in a map</dt>
            <dd><pre><code>
var template = twig({data: '{{ &quot;I like %this% and %that%.&quot;|replace({&quot;%this%&quot;: foo, &quot;%that%&quot;: &quot;bar&quot;}) }}'});
template.render({foo: &quot;foo&quot;}).should.equal(&quot;I like foo and bar.&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>format -></h1>
          <dl>
            <dt>should replace formatting tags with parameters</dt>
            <dd><pre><code>
var template = twig({data: '{{ &quot;I like %s and %s.&quot;|format(foo, &quot;bar&quot;) }}'});
template.render({foo: &quot;foo&quot;}).should.equal(&quot;I like foo and bar.&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>striptags -></h1>
          <dl>
            <dt>should remove tags from a value</dt>
            <dd><pre><code>
var template = twig({data: '{{ &quot;&lt;p&gt;Test paragraph.&lt;/p&gt;&lt;!-- Comment --&gt; &lt;a href=\\&quot;#fragment\\&quot;&gt;Other text&lt;/a&gt;&quot;|striptags }}'});
template.render().should.equal(&quot;Test paragraph. Other text&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>escape -></h1>
          <dl>
            <dt>should convert unsafe characters to HTML entities</dt>
            <dd><pre><code>
var template = twig({data: '{{ &quot;&lt;p&gt;Test paragraph.&lt;/p&gt;&lt;!-- Comment --&gt; &lt;a href=\'#fragment\'&gt;Other text&lt;/a&gt;&quot;|escape }}'});
template.render().should.equal(&quot;&amp;lt;p&amp;gt;Test paragraph.&amp;lt;/p&amp;gt;&amp;lt;!-- Comment --&amp;gt; &amp;lt;a href=&amp;#039;#fragment\&amp;#039;&amp;gt;Other text&amp;lt;/a&amp;gt;&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>e -></h1>
          <dl>
            <dt>should alias escape function with e</dt>
            <dd><pre><code>
var template = twig({data: '{{ &quot;&lt;p&gt;Test paragraph.&lt;/p&gt;&lt;!-- Comment --&gt; &lt;a href=\'#fragment\'&gt;Other text&lt;/a&gt;&quot;|e }}'});
template.render().should.equal(&quot;&amp;lt;p&amp;gt;Test paragraph.&amp;lt;/p&amp;gt;&amp;lt;!-- Comment --&amp;gt; &amp;lt;a href=&amp;#039;#fragment\&amp;#039;&amp;gt;Other text&amp;lt;/a&amp;gt;&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>nl2br -></h1>
          <dl>
            <dt>should convert newlines into html breaks</dt>
            <dd><pre><code>
var template = twig({data: '{{ test|nl2br }}'});
template.render({ test: 'Line 1\r\nLine 2\nLine 3\rLine 4\n\n' }).should.equal(&quot;Line 1&lt;br /&gt;Line 2&lt;br /&gt;Line 3&lt;br /&gt;Line 4&lt;br /&gt;&lt;br /&gt;&quot;);</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>trim -></h1>
          <dl>
            <dt>should trim whitespace from strings</dt>
            <dd><pre><code>
var template = twig({data: '{{ test|trim }}'});
template.render({ test: '\r\n Test\n  ' }).should.equal(&quot;Test&quot;);</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>number_format -></h1>
          <dl>
            <dt>should round to nearest integer if no parameters</dt>
            <dd><pre><code>
var template = twig({data: '{{ 1234.56|number_format }}'});
template.render().should.equal(&quot;1,235&quot;);</code></pre></dd>
            <dt>should have customizable precision</dt>
            <dd><pre><code>
var template = twig({data: '{{ 1234.567890123|number_format(4) }}'});
template.render().should.equal(&quot;1,234.5679&quot;);</code></pre></dd>
            <dt>should have a customizable decimal seperator</dt>
            <dd><pre><code>
var template = twig({data: '{{ 1234.567890123|number_format(2,&quot;,&quot;) }}'});
template.render().should.equal(&quot;1,234,57&quot;);</code></pre></dd>
            <dt>should have a customizable thousands seperator</dt>
            <dd><pre><code>
var template = twig({data: '{{ 1234.5678|number_format(2,&quot;,&quot;,&quot; &quot;) }}'});
template.render().should.equal(&quot;1 234,57&quot;);</code></pre></dd>
            <dt>should handle blank seperators</dt>
            <dd><pre><code>
var template = twig({data: '{{ 1234.5678|number_format(2,&quot;&quot;,&quot;&quot;) }}'});
template.render().should.equal(&quot;123457&quot;);</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Loader -></h1>
      <dl>
        <dt>should load a template from the filesystem asynchronously</dt>
        <dd><pre><code>
twig({
    id:   'fs-node-async',
    path: 'test/templates/test.twig',
    load: function(template) {
        // Render the template
        template.render({
            test: &quot;yes&quot;,
            flag: true
        }).should.equal(&quot;Test template = yes\n\nFlag set!&quot;);
        
        done();
    }
});</code></pre></dd>
        <dt>should load a template from the filesystem synchronously</dt>
        <dd><pre><code>
var template = twig({
    id:   'fs-node-sync',
    path: 'test/templates/test.twig',
    async: false
});
// Render the template
template.render({
    test: &quot;yes&quot;,
    flag: true
}).should.equal(&quot;Test template = yes\n\nFlag set!&quot;);</code></pre></dd>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Blocks -></h1>
      <dl>
        <dt>should load a parent template and render the default values</dt>
        <dd><pre><code>
twig({
    id:   'remote-no-extends',
    path: 'test/templates/template.twig',
    async: false
});
    
// Load the template
twig({ref: 'remote-no-extends'}).render({ }).should.equal( &quot;Default Title - body&quot; );</code></pre></dd>
        <dt>should load a child template and replace the parent block's content</dt>
        <dd><pre><code>
// Test loading a template from a remote endpoint
twig({
    id:   'child-extends',
    path: 'test/templates/child.twig',
            
    load: function(template) {
        template.render({ base: &quot;template.twig&quot; }).should.equal( &quot;Other Title - child&quot; );
        done();
    }
});</code></pre></dd>
        <dt>should have access to a parent block content</dt>
        <dd><pre><code>
// Test loading a template from a remote endpoint
twig({
    id:   'child-parent',
    path: 'test/templates/child-parent.twig',
            
    load: function(template) {
        template.render({ 
            base: &quot;template.twig&quot;, 
            inner: ':value' 
        }).should.equal( &quot;Other Title - body:value:child&quot; );
        done();
    }
});</code></pre></dd>
        <dt>should include blocks from another template for horizontal reuse</dt>
        <dd><pre><code>
// Test horizontal reuse
twig({
    id:   'use',
    path: 'test/templates/use.twig',
            
    load: function(template) {
        // Load the template
        template.render({ place: &quot;diner&quot; }).should.equal(&quot;Coming soon to a diner near you!&quot; );
        done();
    }
});</code></pre></dd>
        <dt>should make the contents of blocks available after they're rendered</dt>
        <dd><pre><code>
// Test rendering and loading one block
twig({
    id:   'blocks',
    path: 'test/templates/blocks.twig',

    load: function(template) {
        // Render the template with the blocks parameter
        template.render({ place: &quot;block&quot; }, {output: 'blocks'}).msg.should.equal(&quot;Coming soon to a block near you!&quot; );
        done();
    }
});</code></pre></dd>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Include -></h1>
      <dl>
        <dt>should load an included template with no context</dt>
        <dd><pre><code>
twig({
    id:   'include',
    path: 'test/templates/include.twig',
    async: false
});
    
// Load the template
twig({ref: 'include'}).render({test: 'tst'}).should.equal( &quot;BeforeTest template = tst\n\nAfter&quot; );</code></pre></dd>
        <dt>should load an included template with additional context</dt>
        <dd><pre><code>
twig({
    id:   'include-with',
    path: 'test/templates/include-with.twig',
    async: false
});
    
// Load the template
twig({ref: 'include-with'}).render({test: 'tst'}).should.equal( &quot;template: before,tst-mid-template: after,tst&quot; );</code></pre></dd>
        <dt>should load an included template with only additional context</dt>
        <dd><pre><code>
twig({
    id:   'include-only',
    path: 'test/templates/include-only.twig',
    async: false
});
    
// Load the template
twig({ref: 'include-only'}).render({test: 'tst'}).should.equal( &quot;template: before,-mid-template: after,&quot; );</code></pre></dd>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Functions -></h1>
      <dl>
        <dt>should allow you to define a function</dt>
        <dd><pre><code>
twig({data: '{{ square(a) }}'}).render({a:4}).should.equal(&quot;16&quot;);</code></pre></dd>
        <dt>should chain with other expressions</dt>
        <dd><pre><code>
twig({data: '{{ square(a) + 4 }}'}).render({a:4}).should.equal(&quot;20&quot;);</code></pre></dd>
        <dt>should chain with filters</dt>
        <dd><pre><code>
twig({data: '{{ echo(a)|default(&quot;foo&quot;) }}'}).render().should.equal(&quot;foo&quot;);</code></pre></dd>
        <dt>should work in for loop expressions</dt>
        <dd><pre><code>
twig({data: '{% for i in list(1, 2, 3) %}{{ i }},{% endfor %}'}).render().should.equal(&quot;1,2,3,&quot;);</code></pre></dd>
        <dt>should be able to differentiate between a function and a variable</dt>
        <dd><pre><code>
twig({data: '{{ square ( square ) + square }}'}).render({square: 2}).should.equal(&quot;6&quot;);</code></pre></dd>
        <dt>should work with boolean operations</dt>
        <dd><pre><code>
twig({data: '{% if echo(true) or echo(false) %}yes{% endif %}'}).render().should.equal(&quot;yes&quot;);</code></pre></dd>
        <dt>should execute functions passed as context values</dt>
        <dd><pre><code>
twig({
    data: '{{ value }}'
}).render({
    value: function() {
        return &quot;test&quot;;
    }
}).should.equal(&quot;test&quot;);</code></pre></dd>
        <dt>should execute functions passed as context values with this mapped to the context</dt>
        <dd><pre><code>
twig({
    data: '{{ value }}'
}).render({
    test: &quot;value&quot;,
    value: function() {
        return this.test;
    }
}).should.equal(&quot;value&quot;);</code></pre></dd>
        <dt>should execute functions passed as context values with arguments</dt>
        <dd><pre><code>
twig({
    data: '{{ value(1, &quot;test&quot;) }}'
}).render({
    value: function(a, b, c) {
        return a + &quot;-&quot; + b + &quot;-&quot; + (c===undefined?&quot;true&quot;:&quot;false&quot;);
    }
}).should.equal(&quot;1-test-true&quot;);</code></pre></dd>
        <dt>should execute functions passed as context value parameters with this mapped to the context</dt>
        <dd><pre><code>
twig({
    data: '{{ value }}'
}).render({
    test: &quot;value&quot;,
    value: function() {
        return this.test;
    }
}).should.equal(&quot;value&quot;);</code></pre></dd>
        <dt>should execute functions passed as context object parameters</dt>
        <dd><pre><code>
twig({
    data: '{{ obj.value }}'
}).render({
    obj: {
         value: function() {
            return &quot;test&quot;;
        }
    }
}).should.equal(&quot;test&quot;);</code></pre></dd>
        <dt>should execute functions passed as context object parameters with arguments</dt>
        <dd><pre><code>
twig({
    data: '{{ obj.value(1, &quot;test&quot;) }}'
}).render({
    obj: {
         value: function(a, b, c) {
            return a + &quot;-&quot; + b + &quot;-&quot; + (c===undefined?&quot;true&quot;:&quot;false&quot;);
        }
    }
}).should.equal(&quot;1-test-true&quot;);</code></pre></dd>
        <dt>should execute functions passed as context object parameters</dt>
        <dd><pre><code>
twig({
    data: '{{ obj[&quot;value&quot;] }}'
}).render({
    obj: {
         value: function() {
            return &quot;test&quot;;
        }
    }
}).should.equal(&quot;test&quot;);</code></pre></dd>
        <dt>should execute functions passed as context object parameters with arguments</dt>
        <dd><pre><code>
twig({
    data: '{{ obj[&quot;value&quot;](1, &quot;test&quot;) }}'
}).render({
    obj: {
         value: function(a, b, c) {
            return a + &quot;-&quot; + b + &quot;-&quot; + (c===undefined?&quot;true&quot;:&quot;false&quot;);
        }
    }
}).should.equal(&quot;1-test-true&quot;);</code></pre></dd>
        <section class="suite">
          <h1>Built-in Functions -></h1>
          <dl>
            <section class="suite">
              <h1>range -></h1>
              <dl>
                <dt>should work over a range of numbers</dt>
                <dd><pre><code>
twig({data: '{% for i in range(0, 3) %}{{ i }},{% endfor %}'}).render().should.equal(&quot;0,1,2,3,&quot;);</code></pre></dd>
                <dt>should work over a range of letters</dt>
                <dd><pre><code>
twig({data: '{% for i in range(&quot;a&quot;, &quot;c&quot;) %}{{ i }},{% endfor %}'}).render().should.equal(&quot;a,b,c,&quot;);</code></pre></dd>
                <dt>should work with an interval</dt>
                <dd><pre><code>
twig({data: '{% for i in range(1, 15, 3) %}{{ i }},{% endfor %}'}).render().should.equal(&quot;1,4,7,10,13,&quot;);</code></pre></dd>
                <dt>should work with .. invocation</dt>
                <dd><pre><code>
twig({data: '{% for i in 0..3 %}{{ i }},{% endfor %}'}).render().should.equal(&quot;0,1,2,3,&quot;);
twig({data: '{% for i in &quot;a&quot; .. &quot;c&quot; %}{{ i }},{% endfor %}'}).render().should.equal(&quot;a,b,c,&quot;);</code></pre></dd>
              </dl>
            </section>
            <section class="suite">
              <h1>cycle -></h1>
              <dl>
                <dt>should cycle through an array of values</dt>
                <dd><pre><code>
twig({data: '{% for i in range(0, 3) %}{{ cycle([&quot;odd&quot;, &quot;even&quot;], i) }};{% endfor %}'}).render().should.equal(&quot;odd;even;odd;even;&quot;);</code></pre></dd>
              </dl>
            </section>
            <section class="suite">
              <h1>date -></h1>
              <dl>
                <dt>should understand timestamps</dt>
                <dd><pre><code>
var date = new Date(946706400 * 1000);
twig({data: '{{ date(946706400)|date(&quot;d/m/Y @ H:i:s&quot;) }}'}).render().should.equal(stringDate(date));</code></pre></dd>
                <dt>should understand relative dates</dt>
                <dd><pre><code>
twig({data: '{{ date(&quot;+1 day&quot;) &gt; date() }}'}).render().should.equal(&quot;true&quot;);
twig({data: '{{ date(&quot;-1 day&quot;) &gt; date() }}'}).render().should.equal(&quot;false&quot;);</code></pre></dd>
                <dt>should support 'now' as a date parameter</dt>
                <dd><pre><code>
twig({data: '{{ date(&quot;now&quot;) }}' }).render().should.equal(new Date().toString());</code></pre></dd>
                <dt>should understand exact dates</dt>
                <dd><pre><code>
var date = new Date(&quot;June 20, 2010 UTC&quot;);
            
twig({data: '{{ date(&quot;June 20, 2010 UTC&quot;)|date(&quot;d/m/Y @ H:i:s&quot;) }}'}).render().should.equal(stringDate(date));</code></pre></dd>
              </dl>
            </section>
            <section class="suite">
              <h1>dump -></h1>
              <dl>
                <dt>should output formatted number</dt>
                <dd><pre><code>
twig({data: '{{ dump(test) }}' }).render({ test: 5 }).should.equal('number(5)' + EOL);</code></pre></dd>
                <dt>should output formatted string</dt>
                <dd><pre><code>
twig({data: '{{ dump(test) }}' }).render({ test: &quot;String&quot; }).should.equal('string(6) &quot;String&quot;' + EOL);</code></pre></dd>
                <dt>should output formatted boolean</dt>
                <dd><pre><code>
twig({data: '{{ dump(test) }}' }).render({ test: true }).should.equal('bool(true)' + EOL);</code></pre></dd>
                <dt>should output formatted null</dt>
                <dd><pre><code>
twig({data: '{{ dump(test) }}' }).render({ test: null }).should.equal('NULL' + EOL);</code></pre></dd>
                <dt>should output formatted object</dt>
                <dd><pre><code>
twig({data: '{{ dump(test) }}' }).render({ test: {} }).should.equal('object(0) {' + EOL + '}' + EOL);</code></pre></dd>
                <dt>should output formatted array</dt>
                <dd><pre><code>
twig({data: '{{ dump(test) }}' }).render({ test: [] }).should.equal('object(0) {' + EOL + '}' + EOL);</code></pre></dd>
                <dt>should output formatted undefined</dt>
                <dd><pre><code>
twig({data: '{{ dump(test) }}' }).render({ test: undefined }).should.equal('undefined' + EOL);</code></pre></dd>
              </dl>
            </section>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Regression Tests -></h1>
      <dl>
        <dt>#47 should not match variables starting with not</dt>
        <dd><pre><code>
// Define and save a template
twig({data: '{% for note in notes %}{{note}}{% endfor %}'}).render({notes:['a', 'b', 'c']}).should.equal(&quot;abc&quot;);</code></pre></dd>
      </dl>
    </section>
    <section class="suite">
      <h1>Twig.js Tests -></h1>
      <dl>
        <section class="suite">
          <h1>empty test -></h1>
          <dl>
            <dt>should identify numbers as not empty</dt>
            <dd><pre><code>
// number
twig({data: '{{ 1 is empty }}'}).render().should.equal(&quot;false&quot; );
twig({data: '{{ 0 is empty }}'}).render().should.equal(&quot;false&quot; );</code></pre></dd>
            <dt>should identify empty strings</dt>
            <dd><pre><code>
// String
twig({data: '{{ &quot;&quot; is empty }}'}).render().should.equal(&quot;true&quot; );
twig({data: '{{ &quot;test&quot; is empty }}'}).render().should.equal(&quot;false&quot; );</code></pre></dd>
            <dt>should identify empty arrays</dt>
            <dd><pre><code>
// Array
twig({data: '{{ [] is empty }}'}).render().should.equal(&quot;true&quot; );
twig({data: '{{ [&quot;1&quot;] is empty }}'}).render().should.equal(&quot;false&quot; );</code></pre></dd>
            <dt>should identify empty objects</dt>
            <dd><pre><code>
// Object
twig({data: '{{ {} is empty }}'}).render().should.equal(&quot;true&quot; );
twig({data: '{{ {&quot;a&quot;:&quot;b&quot;} is empty }}'}).render().should.equal(&quot;false&quot; );
twig({data: '{{ {&quot;a&quot;:&quot;b&quot;} is not empty }}'}).render().should.equal(&quot;true&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>odd test -></h1>
          <dl>
            <dt>should identify a number as odd</dt>
            <dd><pre><code>
twig({data: '{{ (1 + 4) is odd }}'}).render().should.equal(&quot;true&quot; );
twig({data: '{{ 6 is odd }}'}).render().should.equal(&quot;false&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>even test -></h1>
          <dl>
            <dt>should identify a number as even</dt>
            <dd><pre><code>
twig({data: '{{ (1 + 4) is even }}'}).render().should.equal(&quot;false&quot; );
twig({data: '{{ 6 is even }}'}).render().should.equal(&quot;true&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>divisibleby test -></h1>
          <dl>
            <dt>should determine if a number is divisible by the given number</dt>
            <dd><pre><code>
twig({data: '{{ 5 is divisibleby(3) }}'}).render().should.equal(&quot;false&quot; );
twig({data: '{{ 6 is divisibleby(3) }}'}).render().should.equal(&quot;true&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>defined test -></h1>
          <dl>
            <dt>should identify a key as defined if it exists in the render context</dt>
            <dd><pre><code>
twig({data: '{{ key is defined }}'}).render().should.equal(&quot;false&quot; );
twig({data: '{{ key is defined }}'}).render({key: &quot;test&quot;}).should.equal( &quot;true&quot; );</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>none test -></h1>
          <dl>
            <dt>should identify a key as none if it exists in the render context and is null</dt>
            <dd><pre><code>
twig({data: '{{ key is none }}'}).render().should.equal(&quot;false&quot;);
twig({data: '{{ key is none }}'}).render({key: &quot;test&quot;}).should.equal(&quot;false&quot;);
twig({data: '{{ key is none }}'}).render({key: null}).should.equal(&quot;true&quot;);
twig({data: '{{ key is null }}'}).render({key: null}).should.equal(&quot;true&quot;);</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>sameas test -></h1>
          <dl>
            <dt>should identify the exact same type as true</dt>
            <dd><pre><code>
twig({data: '{{ true is sameas(true) }}'}).render().should.equal(&quot;true&quot;);
twig({data: '{{ a is sameas(1) }}'}).render({a: 1}).should.equal(&quot;true&quot;);
twig({data: '{{ a is sameas(&quot;test&quot;) }}'}).render({a: &quot;test&quot;}).should.equal(&quot;true&quot;);
twig({data: '{{ a is sameas(true) }}'}).render({a: true}).should.equal(&quot;true&quot;);</code></pre></dd>
            <dt>should identify the different types as false</dt>
            <dd><pre><code>
twig({data: '{{ false is sameas(true) }}'}).render().should.equal(&quot;false&quot;);
twig({data: '{{ true is sameas(1) }}'}).render().should.equal(&quot;false&quot;);
twig({data: '{{ false is sameas(&quot;&quot;) }}'}).render().should.equal(&quot;false&quot;);
twig({data: '{{ a is sameas(1) }}'}).render({a: &quot;1&quot;}).should.equal(&quot;false&quot;);</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
make[1]: Leaving directory `/home/john/workspace/twig.js'
